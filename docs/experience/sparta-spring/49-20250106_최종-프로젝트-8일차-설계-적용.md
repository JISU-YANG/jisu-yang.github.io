---
layout: note_series
parent: SPARTA 부트캠프
chapter: 49
title: 20250106_최종 프로젝트 8일차 설계 적용
toc: true
nav_exclude: true
---

# 문서 작성
## 알림 흐름도
### Kafka 통합
예약 도메인에서는 전체 알림에 대해 카프카를 사용하지 않고, 
일부만 적용하면서 OpenFeign을 사용 할 수 있도록 팀원의 요청사항이 있었다.
그러나 이후 튜터님의 피드백을 통해 레거시 코드나 카프카에 접근할 수 없는 서비스가 아닌데
굳이 분리를 한 것이 이상하다는 점을 알 수 있었다. 
모든 알림은 카프카에 메시지를 적재하는 것으로 통합하기로 결정했다. 

<img class="cdn-img" id="250106-알림-흐름도.png">

---

## 토픽 명세서
Kafka에 본격적으로 참여하게 되엇는데 정보들이 막연해 문서화에 대한 필요성을 느꼈다.
먼저 토픽 네이밍 전략부터 수정했다. `<서비스명>.<이벤트유형>`
각 토픽의 역할, 전달하는 데이터, 컨슈머 등을 포함해 명세서를 작성했다.

---

## 템플릿 명세서
알림 템플릿에 대해서도 견해를 맞추기 위해 명세서를 작성했다.
담당 팀원과 함께 레퍼런스를 조사하고 논의하여 필요한 파라미터와 폼을 확실하게 정리해두었다.

<img class="cdn-img" id="250106-템플릿-명세서.png">

---

# 주요작업
## 완료
- Auth 서버에서 사용하기 위한 [Slack 정보 조회](https://www.notion.so/Slack-173133b141d680fca843cc5245998fc3?pvs=21) 서비스 로직 API로 추가
- 기능 구현
    - 템플릿 단건 조회
    - 템플릿 컨버터(도메인 서비스) 포맷팅 및 바인딩 로직
    - 관리자용 [알림 발송](https://www.notion.so/169133b141d6806491ebc5c36a6546fc?pvs=21) API (로우 데이터)
    - 알림 히스토리 저장
    - 알림 이벤트를 통한 알림 전체 서비스 로직 테스트(카프카 메시지 수신 및 유저 정보 조회 미구현 더미값 대체)

---

## 알림 이벤트 서비스
전처리 로직이 상당히 복잡하여 8단계의 TODO로 나누고, 현재 불가능한 데이터는 더미 로직으로 대체했다.
가능한 영역부터 빠르게 서비스들을 돌아다니면 새로운 설계에 맞춰 기능을 추가하고 수정했다.
서비스와 메서드로 기능들이 깔끔하게 분리된 로직을 보니 너무 기분이 좋고 설랬다.

---

## 안건
내일 회의 안건으로는 유저 정보를 알림에서 다시 관할해도 되는지 여부와 
요청 로직 구현에 대해 논의할 예정이다. 
또한, 카프카 컨슈머 기능을 구현하여 PR을 생성할 계획이다.


